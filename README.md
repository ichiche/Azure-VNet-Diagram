# Description

- The script is developed to export the VNet information in the format that recognized by **Diagrams.net**
- Virtual Network Diagram is actually generated by **Diagrams.net**
- Support up to 4 Tier Sequential vNet Peering
- 4 Types of Shapes
    - vNet With ExpressRoute Gateway: Purple
    - vNet With VPN Gateway: Blue
    - vNet with Peering: Grey
    - vNet With No Peering: Red
- Exclude Databricks Virtual Network 
- [Optional] import the sample **diagrams_csv_sample.txt** to **Diagrams.net** for demonstration

# Instruction

1. Modify Global Parameter if necessary
1. Collect the Text File
1. Login https://app.diagrams.net/
1. From the Web Console, click Arrange > Insert > Advanced > CSV
1. Copy the content of CSV File and overwrite the input field in Web Console
1. Click Import
1. If you would like to save as other format, Click File > Export as  

# Baseline 

**The network flow diagram follow the sequence shown below:**

1. Virtual Network with ExpressRoute Gateway
1. Virtual Network with VPN Gateway
1. Highest Peering Count
1. Virtual Network Name in alphabetical order

# Constraints

- Partially automatic for generate the diagram
- Peering State is not shown
- Gateway Transit Status is not shown
- Associated ExpressRoute Circuit is not shown
- Subnet(s) of Virtual Network is not shown
- IP Addresses are not shown
- Subscription or Resource not found message could be ignore if the user account do not have access to all peered virtual network

# Additional Information

Detail of Virtual Network and Peering are stored to below variable

```
$Global:vNet | Export-Csv -Path "C:\Temp\vNet-Detail.csv -NoTypeInformation -Confirm:$false -Force
$Global:vNetPeering | Export-Csv -Path "C:\Temp\vNetPeering-Detail.csv" -NoTypeInformation -Confirm:$false -Force
```
# Reference

- [Examples: Import from CSV to draw.io diagrams](https://drawio-app.com/import-from-csv-to-drawio)